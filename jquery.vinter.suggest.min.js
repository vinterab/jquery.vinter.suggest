/*! jquery.vinter.suggest - v1.0.0 - 2012-06-12
* https://github.com/vinterab/jquery.vinter.suggest/
* Copyright (c) 2012 Vinter AB; Licensed MIT */
(function(a,b){a.fn.suggest=function(c){var d={url:"",cssClasses:{hover:"s-hover",focus:"s-focus",suggestResult:"suggest"},minCharacters:1,highlightMatches:!0,onSelect:b,autoSubmit:!0},e,f=0;return c=a.extend(d,c),this.each(function(){function j(a){return function(){d.val(a.text),g.html("").hide(),typeof c.onSelect=="function"&&c.onSelect(a),c.autoSubmit&&d.closest("form").submit()}}function k(a){return function(){g.find("li").removeClass(c.cssClasses.hover),a&&(d.val(a.text()),a.addClass(c.cssClasses.hover)),i=a}}function l(d,e){var f,h=new RegExp("("+e+")","ig");g.html("").hide();for(f=0;f<d.length;f++){var l=a("<li />"),m=d[f].text;c.highlightMatches===!0&&(m=m.replace(h,"<strong>$1</strong>")),l.append(m).click(j(d[f])).mouseover(k(l)),g.append(l)}g.find("li").length>0&&(i=b,g.show())}function m(){if(c.url&&typeof c.url=="string"){var b=d.val();g.find("li").length===0&&g.html('<li class="s-searching">Searching...</li>').show(),clearTimeout(e),e=setTimeout(function(){a.getJSON(c.url,{q:b},function(a){a?l(a,b):g.html("").hide()})},300)}}function n(c){switch(c.keyCode){case 13:return a(i).trigger("click"),!1;case 40:return i===b?k(g.find("li:first").eq(0))():i[0]!==g.find("li:last")[0]&&k(i.next().eq(0))(),!1;case 38:return i===b?k(g.find("li:last").eq(0))():i[0]!==g.find("li:first")[0]&&k(i.prev().eq(0))(),!1;default:return m(),!0}}var d=a(this),g=a("<ul />"),h="suggest-"+ ++f,i;g.addClass(c.cssClasses.suggestResult+" "+h).hide(),d.attr("autocomplete","off").addClass(h).after(g).keyup(n).focus(function(){d.val().length&&m(),a(document).on("click.suggest",function(b){a(b.target).hasClass(h)||(g.slideUp(150,function(){d.removeClass(c.cssClasses.focus)}),a(document).off("click.suggest"))}),d.addClass(c.cssClasses.focus)})})}})(jQuery);